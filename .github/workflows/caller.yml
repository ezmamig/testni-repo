name: caller-workflow
run-name: Test environment - caller
on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  checkoutRepo:
    runs-on: [windows-latest]
    steps:
      - name: Checkout repo
        uses: actions/checkout@v1

      - name: Read SupportedOS from JSON
        id: read-supportedos
        run: |
          ls ${{ github.workspace }}
          echo ${{ github.workspace }}
        shell: powershell

  call-workflow-2-in-local-repo:
    strategy:
      matrix:
        target: ["dev", "stage", "prod"]
    uses: ezmamig/testni-repo/.github/workflows/callable2.yml@master
    with:
      tpt_file_name: "tptConfig1.json, tptConfig2.json"
      target: ${{ matrix.target }}
    secrets:
      envPAT: envPath

  tempJob:
    needs: [call-workflow-2-in-local-repo]
    runs-on: [ubuntu-latest]
    steps:
      - name: Debug matrix functionality
        run: echo "tempJob output"
